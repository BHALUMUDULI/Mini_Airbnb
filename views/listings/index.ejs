<% layout("/layouts/boilerplate") %>

<!-- FILTER SECTION -->
<div id="filters" class="d-flex align-items-center mb-3">
    <div class="filter-scroll-container d-flex align-items-center">

        <% const categories = [
            { type: "Villa", icon: "fa-building" },
            { type: "Beach", icon: "fa-umbrella-beach" },
            { type: "Mountain", icon: "fa-mountain" },
            { type: "Lake", icon: "fa-water" },
            { type: "Cabin", icon: "fa-tree" },
            { type: "Iconic Cities", icon: "fa-city" },
            { type: "Camping", icon: "fa-campground" },
            { type: "Farms", icon: "fa-tractor" },
            { type: "Rooms", icon: "fa-bed" }
        ]; %>

        <% categories.forEach(c => { %>
            <div class="filter" data-category="<%= c.type %>" onclick="applyFilter('<%= c.type %>')">
                <div><i class="fa-solid <%= c.icon %>"></i></div>
                <p><%= c.type %></p>
            </div>
        <% }) %>

    </div>

    <!-- TAX SWITCH -->
    <div class="form-check form-switch ms-3">
        <input class="form-check-input" type="checkbox" id="toggleTax" onchange="toggleTaxes()">
        <label class="form-check-label" for="toggleTax">Include Taxes</label>
    </div>
</div>

<!-- LISTINGS GRID -->
<div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">

    <% listings.forEach(listing => { %>

        <div class="col listing-card" data-category="<%= listing.category %>">

            <a href="/listings/<%= listing._id %>" class="text-decoration-none text-dark">

                <div class="card border-0 shadow-sm">

                    <!-- IMAGE -->
                    <img
                        src="<%= listing.image.url %>"
                        alt="Listing Image"
                        class="card-img-top rounded-top"
                        style="height: 200px; object-fit: cover;"
                    />

                    <!-- BODY -->
                    <div class="card-body">

                        <h5 class="fw-bold mb-1"><%= listing.title %></h5>

                        <p class="text-muted small mb-1"><%= listing.location %>, <%= listing.country %></p>

                        <p class="fw-semibold mb-0">
                            â‚¹ <%= listing.price %> <span class="text-muted small">/ night</span>
                        </p>

                    </div>

                </div>

            </a>

        </div>

    <% }) %>

</div>

<script>
    // FILTER FUNCTION
    function applyFilter(category) {
        const cards = document.querySelectorAll(".listing-card");
        cards.forEach(card => {
            const cardCategory = card.dataset.category;
            card.style.display = cardCategory === category || category === "All" ? "block" : "none";
        });
    }

    // TAX TOGGLE
    function toggleTaxes() {
        console.log("Tax toggled");
        // you can implement tax calculation here later
    }
</script>
